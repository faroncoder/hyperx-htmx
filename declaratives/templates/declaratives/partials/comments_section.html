{% load static %}
{% load htmx_tags %}
{% load django_bootstrap5 %} 
{% bootstrap_css %}
{% bootstrap_javascript %}
<!DOCTYPE html> 
<html lang="en">
    <head>
    <meta charset="UTF-8">
    
  <script type="text/javascript" src="{% static 'js/htmx.min.js' %}"></script>
  <script type ="text/javascript" src="{% static 'js/json_enc.js' %}"></script>
  <script type ="text/javascript" src="{% static 'js/ws.js' %}"></script>
  
  <link type="text/css" href="{% static 'css/simple_datatable.css' %}" rel="stylesheet" />
  <link type="text/css" href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" />
  <link type="text/css" href="{% static 'css/all.min.css' %}" rel="stylesheet" />
  <link type="text/css" href="{% static 'css/styles.css' %}" rel="stylesheet" />
  <link type="text/css" href="{% static 'css/default.css' %}" rel="stylesheet" />

    <!-- Feather Icons -->

      <script type ="text/javascript" src="{% static 'js/feather.min.js' %}"></script>
        <script type ="text/javascript" src="{% static 'js/loader.js' %}"></script>

</head>
<body>
<div class="comments-section">
    <h6>Comments ({{ comments.count }})</h6>
    
    {% for comment in comments %}
        <div class="border-start border-primary ps-3 mb-2">
            {% include 'declaratives/partials/comment_item.html' %}
        </div>
    {% empty %}
        <p class="text-muted small">No comments yet.</p>
    {% endfor %}
    
    {% if request.user.is_authenticated %}
        <form id="comment-form-{{ task.id }}"
              class="mt-3"
              hx-post="{% url 'declaratives:add_comment' task.id %}"
              hx-target="#comments-list-{{ task.id }}"
              hx-swap="beforeend">
            {% csrf_token %}
            <div class="input-group input-group-sm">
                <input type="text" 
                       name="content" 
                       class="form-control" 
                       placeholder="Add a comment...">
                <button class="btn btn-outline-primary" type="submit">Send</button>
            </div>
        </form>
        
        <div id="comments-list-{{ task.id }}"></div>
    {% endif %}
</div>




  <script type="text/javascript" src="{% static 'js/htmx_client.js' %}" defer></script>
  <script type="text/javascript" src="{% static 'js/localStorage.min.js' %}" id="localStorageScript"
    onload="window.localStorageReady = true; console.log('âœ… localStorage.min.js loaded');"></script>
  <script type="text/javascript" src="{% static 'js/bootstrap.bundle.min.js' %}"></script> 
  <script type="text/javascript" src="{% static 'js/base_start.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/toasts.js' %}"></script>



{% bootstrap_javascript %}
</body>
</html>
